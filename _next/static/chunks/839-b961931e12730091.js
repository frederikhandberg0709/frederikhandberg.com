"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[839],{75839:(e,t,r)=>{r.d(t,{A:()=>z});var s=r(95155),n=r(97049);function a(e){if(!e)return"";let t=new Date(1e3*e.created_at),r=t.getFullYear(),s=("0"+(t.getMonth()+1)).slice(-2),n=("0"+t.getDate()).slice(-2),a=t.getHours(),l=a,i=("0"+t.getMinutes()).slice(-2),o="AM";return a>12?(l=a-12,o="PM"):12===a?(l=12,o="PM"):0==a&&(l=12),n+"-"+s+"-"+r+", "+l+":"+i+" "+o}var l=r(71007),i=r(71366),o=r(66766),c=r(12115),d=r(90637),u=r(6874),m=r.n(u);let h=e=>{for(let t of[/(?:youtube\.com\/watch\?v=|youtu\.be\/|youtube\.com\/embed\/)([^&\n?#]+)/,/youtube\.com\/watch\?.*v=([^&\n?#]+)/]){let r=e.match(t);if(r)return r[1]}return null},g=e=>/(?:youtube\.com|youtu\.be)/.test(e);function x(e){let{url:t,fallback:r}=e,[n,a]=(0,c.useState)(null),[l,i]=(0,c.useState)(!0),[o,d]=(0,c.useState)(!1);return((0,c.useEffect)(()=>{let e=async e=>{let t=h(e);if(!t)throw Error("Invalid YouTube URL");try{let t=await fetch("https://www.youtube.com/oembed?url=".concat(encodeURIComponent(e),"&format=json"));if(t.ok){let r=await t.json();if(r.thumbnail_url)try{if(!(await fetch(r.thumbnail_url,{method:"HEAD"})).ok)throw Error("Thumbnail not accessible")}catch(e){throw Error("Thumbnail not accessible")}let s={title:r.title||"YouTube Video",description:r.author_name?"By ".concat(r.author_name):"Watch this video on ".concat(r.provider_name),image:r.thumbnail_url||"",url:e,siteName:r.provider_name||"YouTube"};a(s);return}}catch(e){console.log("oEmbed failed or thumbnail not accessible")}let r="";for(let e of["https://img.youtube.com/vi/".concat(t,"/maxresdefault.jpg"),"https://img.youtube.com/vi/".concat(t,"/hqdefault.jpg")])try{if((await fetch(e,{method:"HEAD"})).ok){r=e;break}}catch(e){continue}if(!r)throw Error("No accessible thumbnail found");let s="YouTube Video",n="Watch this video on YouTube";try{let t="https://api.allorigins.win/get?url=".concat(encodeURIComponent(e)),r=await fetch(t),a=await r.json(),l=a.contents.match(/<title[^>]*>([^<]+)<\/title>/i);if(l&&l[1]){let e=l[1].replace(" - YouTube","").trim();e&&"YouTube"!==e&&(s=e)}let i=a.contents.match(/<meta[^>]+name="description"[^>]+content="([^"]*)"[^>]*>/i);i&&i[1]&&(n=i[1])}catch(e){console.log("Scraping failed, using basic info")}a({title:s,description:n,image:r,url:e,siteName:"YouTube"})},r=async e=>{let t="https://api.allorigins.win/get?url=".concat(encodeURIComponent(e)),r=await fetch(t),s=await r.json(),n=new DOMParser().parseFromString(s.contents,"text/html"),l=e=>{let t=n.querySelector('meta[property="og:'.concat(e,'"]')),r=n.querySelector('meta[name="'.concat(e,'"]')),s=n.querySelector('meta[name="twitter:'.concat(e,'"]'));return(null==t?void 0:t.getAttribute("content"))||(null==r?void 0:r.getAttribute("content"))||(null==s?void 0:s.getAttribute("content"))||""};a({title:l("title")||n.title||"No title",description:l("description")||"",image:l("image")||"",url:l("url")||e,siteName:l("site_name")||""})};(async()=>{try{g(t)?await e(t):await r(t)}catch(e){console.error("Failed to fetch metadata:",e),d(!0)}finally{i(!1)}})()},[t]),l)?(0,s.jsxs)("div",{className:"w-full animate-pulse",children:[(0,s.jsx)("div",{className:"h-48 rounded-t-lg bg-gray-200 dark:bg-gray-500"}),(0,s.jsxs)("div",{className:"space-y-3 rounded-b-lg border border-gray-200 p-4 dark:border-gray-500",children:[(0,s.jsx)("div",{className:"h-4 w-3/4 rounded bg-gray-200 dark:bg-gray-500"}),(0,s.jsx)("div",{className:"h-3 rounded bg-gray-200 dark:bg-gray-500"}),(0,s.jsx)("div",{className:"h-3 w-5/6 rounded bg-gray-200 dark:bg-gray-500"})]})]}):o||!n?r||(0,s.jsx)("a",{href:t,className:"break-all text-blue-600 underline hover:text-blue-800",target:"_blank",rel:"noopener noreferrer",children:t}):(0,s.jsxs)(m(),{href:t,target:"_blank",rel:"noopener noreferrer",className:"group block w-full overflow-hidden rounded-lg border border-gray-200 bg-white shadow-sm transition-shadow duration-200 hover:shadow-md dark:border-gray-900 dark:bg-gray-900",children:[n.image&&(0,s.jsx)("div",{className:"aspect-video overflow-hidden",children:(0,s.jsx)("img",{src:n.image,alt:n.title,className:"h-full w-full object-cover transition-transform duration-200 group-hover:scale-105",onError:e=>{e.target.style.display="none"}})}),(0,s.jsxs)("div",{className:"p-4",children:[(0,s.jsx)("h3",{className:"mb-2 line-clamp-2 font-semibold text-gray-900 transition-colors group-hover:text-blue-600 dark:text-white dark:group-hover:text-blue-500",children:n.title}),n.description&&(0,s.jsx)("p",{className:"mb-3 line-clamp-3 text-sm text-gray-600 dark:text-gray-400",children:n.description}),(0,s.jsxs)("div",{className:"flex items-center text-xs text-gray-500 dark:text-gray-400",children:[n.siteName&&(0,s.jsx)("span",{className:"font-medium",children:n.siteName}),(0,s.jsx)("span",{className:"ml-auto max-w-xs truncate",children:new URL(t).hostname})]})]})]})}let p=function(e){let t=/(#\w+)/g,r=e.split(/(\s+)/).flatMap(e=>e.split(t));return(0,s.jsx)(c.Fragment,{children:r.map((e,t)=>e.startsWith("#")?(0,s.jsx)("span",{className:"font-bold text-blue-500",children:e},t):(0,s.jsx)("span",{children:e},t))})};var f=r(98590);let b=()=>{let e=(0,c.useContext)(f.b);if(void 0===e)throw Error("useImageOverlay must be used within an ImageOverlayProvider");return e};var v=r(88275);class y{static createCombinedRegex(){let e=this.BECH32_NOTE_REGEX.source.slice(1,-1),t=this.NEVENT_REGEX.source.slice(1,-1),r=this.NOSTR_BECH32_NOTE_REGEX.source.slice(1,-1),s=this.NOSTR_NEVENT_REGEX.source.slice(1,-1);return RegExp("(".concat("https?:\\/\\/[^\\s\\n]+","|").concat(e,"|").concat(t,"|").concat(r,"|").concat(s,")"),"g")}static isNostrReference(e){let t=e.trim();return this.BECH32_NOTE_REGEX.lastIndex=0,this.NEVENT_REGEX.lastIndex=0,this.NOSTR_BECH32_NOTE_REGEX.lastIndex=0,this.NOSTR_NEVENT_REGEX.lastIndex=0,this.BECH32_NOTE_REGEX.test(t)||this.NEVENT_REGEX.test(t)||this.NOSTR_BECH32_NOTE_REGEX.test(t)||this.NOSTR_NEVENT_REGEX.test(t)}static extractNoteIdFromReference(e){return e.trim().replace(/^nostr:/,"")}static convertToHex(e){try{if(e.startsWith("note1")){let{data:t}=v.Qe.decode(e);if("string"==typeof t&&/^[a-f0-9]{64}$/.test(t))return t;return console.error("Decoded note ID is not in the expected hex format:",t),""}if(e.startsWith("nevent1")){let{type:t,data:r}=v.Qe.decode(e);if("nevent"!==t)return console.error("Decoded nevent is not of type 'nevent':",t),"";if(r.id&&/^[a-f0-9]{64}$/.test(r.id))return r.id;return console.error("nevent ID field is not in the expected hex format:",r.id),""}if(/^[a-f0-9]{64}$/.test(e))return e;return console.error("Note ID is not in a recognized format:",e),""}catch(e){return console.error("Error decoding note ID:",e),""}}static extractNoteIds(e){let t,r,s,n=[];for(;null!==(t=this.BECH32_NOTE_REGEX.exec(e));)t[1]&&n.push(t[1]);for(;null!==(r=this.NEVENT_REGEX.exec(e));)if(r[1])try{let{type:e,data:t}=v.Qe.decode(r[1]);if("note"===e){let e=v.Qe.noteEncode(t);n.push(e)}else if("nevent"===e){let e=v.Qe.noteEncode(t.id);n.push(e)}}catch(e){console.error("Error decoding nevent ID:",e)}let a=/nostr:(nevent1[a-zA-Z0-9]{20,})/g;for(;null!==(s=a.exec(e));)if(s[1])try{let{type:e,data:t}=v.Qe.decode(s[1]);if("note"===e){let e=v.Qe.noteEncode(t);n.push(e)}else if("nevent"===e){let e=v.Qe.noteEncode(t.id);n.push(e)}}catch(e){console.error("Error decoding nostr nevent ID:",e)}return[...new Set(n)]}static removeNostrReferences(e){let t=e;return(t=(t=t.replace(this.NOSTR_PROFILE_REGEX,"")).replace(this.NOSTR_NPROFILE_REGEX,"")).split("\n").map(e=>e.replace(/(\S)[ \t]{2,}/g,"$1 ")).join("\n")}}y.BECH32_NOTE_REGEX=/(note1[a-zA-Z0-9]{20,})/g,y.NEVENT_REGEX=/(nevent1[a-zA-Z0-9]{20,})/g,y.NOSTR_BECH32_NOTE_REGEX=/(nostr:note[a-zA-Z0-9]{59,65})/g,y.NOSTR_NEVENT_REGEX=/(nostr:nevent1[a-zA-Z0-9]{20,})/g,y.NOSTR_PROFILE_REGEX=/(nostr:npub[a-zA-Z0-9]{59,65})/g,y.NOSTR_NPROFILE_REGEX=/nostr:nprofile1[qpzry9x8gf2tvdw0s3jn54khce6mua7l]+/;class N{static cleanText(e){let t=e;return(t=(t=t.split("\n").map(e=>""===e.trim()?"":e).join("\n")).split("\n").map(e=>e.replace(/(\S)[ ]{2,}/g,"$1 ")).join("\n")).trim()}static truncateUrls(e){return e.replace(/(https?:\/\/[^\s]{30,})/g,e=>{try{let t=new URL(e);return"".concat(t.hostname,"/...")}catch(t){return"".concat(e.substring(0,25),"...")}})}}class j{static isMediaUrl(e){return this.isImageUrl(e)||this.isVideoUrl(e)}static isImageUrl(e){return/https:\/\/.*?\.(jpeg|jpg|png|webp)/i.test(e)}static isVideoUrl(e){return/https:\/\/.*?\.(mp4|avi|mov)/i.test(e)}static isPreviewableUrl(e){try{let t=new URL(e);return!(["localhost","127.0.0.1"].includes(t.hostname)||[".pdf",".zip",".tar",".gz",".doc",".docx",".xls",".xlsx",".ppt",".pptx",".txt",".csv"].some(t=>e.toLowerCase().endsWith(t)))&&("http:"===t.protocol||"https:"===t.protocol)}catch(e){return!1}}static extractUrls(e){return e.match(this.URL_REGEX)||[]}static cleanUrl(e){return e.replace(/[.,;!?]*$/,"")}}j.URL_REGEX=/https?:\/\/[^\s\n]+/g;class E{static process(e){let t,r=[],s=0,n=y.extractNoteIds(e),a=y.createCombinedRegex(),l=[],i=0;for(;null!==(t=a.exec(e));){if(t.index>i){let r=e.substring(i,t.index);r&&l.push(r)}l.push(t[0]),i=t.index+t[0].length}if(i<e.length){let t=e.substring(i);t&&l.push(t)}let o="",c=()=>{if(o.trim()){let e=y.removeNostrReferences(o);e=e.replace(/(nostr:)?(note1[a-zA-Z0-9]{20,}|nevent1[a-zA-Z0-9]{20,})/g,""),e=N.truncateUrls(e),(e=N.cleanText(e))&&r.push({type:"text",content:e,index:s++}),o=""}};l.forEach(e=>{let t=e.trim();if(/^https?:\/\/[^\s]+$/.test(e)){let t=j.cleanUrl(e);if(j.isMediaUrl(t)){c();let n=j.isVideoUrl(t);r.push({type:n?"video":"image",content:t,index:s++,metadata:{originalUrl:e}})}else j.isPreviewableUrl(t)?(c(),r.push({type:"link",content:t,index:s++,metadata:{originalUrl:e}})):o+=e}else if(y.isNostrReference(t)){c();let e=y.extractNoteIdFromReference(t);r.push({type:"nostr_note",content:e,index:s++,metadata:{originalUrl:t}})}else o+=e}),c();let d=r.some(e=>"image"===e.type||"video"===e.type),u=r.some(e=>"link"===e.type);return{blocks:r,noteIds:n,hasMedia:d,hasLinks:u}}}let w=e=>{let{noteId:t}=e,[r,i]=(0,c.useState)(!1),u=y.convertToHex(t),{loadProfile:m,getProfile:h}=(0,d.K)(),{events:g,isLoading:x}=(0,n.zE)({filter:{ids:u?[u]:[],kinds:[1],limit:1},enabled:!!u}),p=g.length>0?g[0]:null;(0,c.useEffect)(()=>{(null==p?void 0:p.pubkey)&&m(p.pubkey)},[null==p?void 0:p.pubkey,m]);let f=(null==p?void 0:p.pubkey)?h(p.pubkey):null;if(x)return(0,s.jsxs)("div",{className:"animate-pulse rounded-md border bg-gray-50 p-3 dark:border-gray-800 dark:bg-gray-800",children:[(0,s.jsx)("div",{className:"mb-2 h-4 w-3/4 rounded bg-gray-200 dark:bg-gray-700"}),(0,s.jsx)("div",{className:"h-4 w-1/2 rounded bg-gray-200 dark:bg-gray-700"})]});if(!u)return(0,s.jsx)("div",{className:"rounded-md border bg-gray-50 p-4 dark:bg-gray-800",children:(0,s.jsx)("div",{className:"text-sm text-red-500",children:"Invalid note ID format"})});if(!p)return null;let b=p.content.trim().length>0;return(0,s.jsxs)("div",{className:"rounded-lg border border-gray-200 p-4 transition hover:border-gray-300 dark:border-gray-900 dark:bg-black dark:hover:border-gray-800",children:[(0,s.jsxs)("div",{className:"mb-2 flex items-center",children:[(0,s.jsxs)("div",{className:"group flex items-center gap-2",children:[(null==f?void 0:f.picture)&&!r?(0,s.jsx)(o.default,{src:f.picture,alt:"".concat(f.display_name,"'s profile"),width:30,height:30,onError:()=>i(!0),className:"h-[30px] w-[30px] rounded-full object-cover"}):(0,s.jsx)("div",{className:"flex h-[30px] w-[30px] items-center justify-center rounded-full bg-gray-200 dark:bg-gray-700",children:(0,s.jsx)(l.A,{size:16,className:"text-gray-400"})}),(0,s.jsxs)("div",{className:"flex items-center gap-2.5",children:[(0,s.jsx)("div",{className:"text-sm font-semibold text-black group-hover:text-blue-500 dark:text-white",children:(null==f?void 0:f.display_name)||(null==f?void 0:f.name)||"".concat(p.pubkey.substring(0,8),"...")}),(0,s.jsxs)("div",{className:"text-sm text-gray-500",children:["@",null==f?void 0:f.name]})]})]}),(0,s.jsx)("div",{className:"ml-auto text-right text-xs text-gray-500",children:a(p)})]}),b&&(0,s.jsx)(O,{content:p.content})]})};var k=r(88240),_=r(23629),R=r(79629),T=r(91924),S=r(35508),I=r(51362);function O(e){let{content:t,className:r=""}=e,{theme:n}=(0,I.D)(),a="dark"===n?T.A:S.A,{setOverlayImage:l}=b(),[i,d]=(0,c.useState)(new Set),{blocks:u}=E.process(t),h=e=>{d(t=>new Set(t).add(e))},g=(e,t,r)=>{if(!e)return!1;if(e.startsWith("```"))return!0;let s=0;for(let e=0;e<=t;e++){var n;(null==(n=r[e])?void 0:n.startsWith("```"))&&s++}if(s%2==1||/^\s*[-*+]\s/.test(e))return!0;if(/^\s+/.test(e)&&!/^\s*[-*+]\s/.test(e))for(let e=t-1;e>=0;e--){let t=r[e];if(t){if(/^\s*[-*+]\s/.test(t))return!0;if(t.trim()&&!t.match(/^\s/))break}}return!!RegExp("(\\*\\*.*?\\*\\*|__.*?__|(?<!\\*)\\*(?!\\*).*?\\*(?!\\*)|(?<!_)_(?!_).*?_(?!_)|`.*?`|\\[.*?\\]\\(.*?\\))").test(e)},f=e=>{if("string"==typeof e)return p(e);if(c.isValidElement(e)){let t=e.props;return c.cloneElement(e,t,f(t.children))}return Array.isArray(e)?e.map((e,t)=>(0,s.jsx)(c.Fragment,{children:f(e)},t)):e},v=(e,t,r)=>{let n=t===r-1;switch(e.type){case"text":let c=e.content.split("\n"),d=[],u="",b=!1;for(let e=0;e<c.length;e++){let t=c[e];g(t,e,c)||b?(u+=(u?"\n":"")+t,b=!0,t.startsWith("```")&&u.split("```").length%2==0?(d.push({content:u,isMarkdown:!0}),u="",b=!1):!(e+1>=c.length)&&g(c[e+1],e+1,c)||t.startsWith("```")||(d.push({content:u,isMarkdown:!0}),u="",b=!1)):(u&&(d.push({content:u,isMarkdown:!0}),u=""),d.push({content:t,isMarkdown:!1}))}return u&&d.push({content:u,isMarkdown:!0}),(0,s.jsx)("div",{className:"leading-normal",children:(0,s.jsx)("div",{className:"prose prose-gray dark:prose-invert max-w-none",children:d.map((e,t)=>(0,s.jsx)("div",{children:e.isMarkdown?(0,s.jsx)(k.oz,{remarkPlugins:[_.A],components:{p:e=>{let{children:t}=e;return(0,s.jsx)(s.Fragment,{children:t})},li:e=>{let{children:t}=e;return(0,s.jsx)("li",{children:f(t)})},code(e){let{className:t,children:r,...n}=e,l=/language-(\w+)/.exec(t||""),i=l?l[1]:"";return t&&i?(0,s.jsx)(R.A,{style:a,language:i,PreTag:"div",className:"my-4 rounded-md",children:String(r).replace(/\n$/,"")}):(0,s.jsx)("code",{className:"rounded bg-gray-100 px-1 py-0.5 font-mono text-sm dark:bg-gray-800",...n,children:r})},ul:e=>{let{children:t}=e;return(0,s.jsx)("ul",{className:"my-2 ml-5 list-disc pl-0",children:t})},strong:e=>{let{children:t}=e;return(0,s.jsx)("strong",{className:"font-semibold",children:t})},em:e=>{let{children:t}=e;return(0,s.jsx)("em",{className:"italic",children:t})}},children:e.content}):(0,s.jsx)("div",{className:"whitespace-pre-wrap",children:p(e.content||"\xa0")})},t))})},e.index);case"image":if(i.has(e.content))return null;return(0,s.jsx)("div",{className:"relative ".concat(n?"mt-3":"my-3"),children:(0,s.jsx)(o.default,{src:e.content,alt:"Media content",onClick:()=>l(e.content),width:1e3,height:1e3,className:"w-full scale-100 cursor-pointer rounded-xl transition hover:opacity-90 active:scale-[0.98]",onError:()=>h(e.content)})},e.index);case"video":return(0,s.jsx)("video",{src:e.content,className:"w-full rounded-[10px] ".concat(n?"mt-3":"my-3"),controls:!0,autoPlay:!0,muted:!0},e.index);case"link":return(0,s.jsx)("div",{className:n?"mt-3":"my-3",children:(0,s.jsx)(x,{url:e.content,fallback:(0,s.jsx)(m(),{href:e.content,className:"break-all text-blue-500 underline hover:text-blue-600 dark:text-blue-400 dark:hover:text-blue-300",target:"_blank",rel:"noopener noreferrer",children:e.content})})},e.index);case"nostr_note":return(0,s.jsx)("div",{className:n?"mt-3":"my-3",children:(0,s.jsx)(w,{noteId:e.content})},e.index);default:return null}};return(0,s.jsx)("div",{className:"flex flex-col ".concat(r),children:u.map((e,t)=>v(e,t,u.length))})}function C(e){let{content:t,className:r=""}=e;return(0,s.jsx)(O,{content:t,className:"text-sm ".concat(r)})}function A(e){let{profilePicture:t,displayName:r,username:n,content:u,showReplies:m=!1,replies:h=[],onToggleReplies:g,timestamp:x,pubkey:p}=e,[f,b]=(0,c.useState)(!1),{loadProfile:v,getProfile:y}=(0,d.K)();(0,c.useEffect)(()=>{p&&v(p)},[p,v]);let N=p?y(p):null,j=t||(null==N?void 0:N.picture),E=r||(null==N?void 0:N.display_name),w=n||(null==N?void 0:N.name),k=(e,t)=>e.filter(e=>{let r=e.tags.filter(e=>"e"===e[0]);if(0===r.length)return!1;let s=r[r.length-1];return s&&s[1]===t}).sort((e,t)=>e.created_at-t.created_at),_=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=y(e.pubkey),n=Math.min(t,6),i=k(h,e.id);return(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{style:{marginLeft:"".concat(16*n,"px")},className:"border-l-2 border-gray-300 py-3 pl-3 dark:border-gray-600",children:(0,s.jsxs)("div",{className:"flex items-start gap-3",children:[(null==r?void 0:r.picture)?(0,s.jsx)(o.default,{src:r.picture,alt:"".concat(r.display_name,"'s profile picture"),width:32,height:32,className:"h-8 w-8 rounded-full object-cover"}):(0,s.jsx)("div",{className:"flex h-8 w-8 items-center justify-center rounded-full bg-gray-200 dark:bg-gray-800",children:(0,s.jsx)(l.A,{size:16,className:"text-gray-400"})}),(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 text-xs text-gray-600 dark:text-gray-400",children:[(0,s.jsx)("span",{className:"font-semibold",children:(null==r?void 0:r.display_name)||"@".concat(null==r?void 0:r.name)||0}),(0,s.jsx)("span",{children:"•"}),(0,s.jsx)("span",{children:a(e)})]}),(0,s.jsx)("div",{className:"mt-1",children:(0,s.jsx)(C,{content:e.content})})]})]})}),i.length>0&&(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)("div",{className:"absolute bottom-0 top-0 w-0.5 bg-gray-300 dark:bg-gray-600",style:{left:"".concat(16*n,"px")}}),(0,s.jsx)("div",{children:i.map(e=>_(e,t+1))})]})]},e.id)},R=u.trim().length>0,T=h.length>0;return(0,s.jsxs)("div",{className:"flex flex-col gap-2.5 border-gray-200 px-4 py-4 transition duration-200 hover:border-gray-300 dark:border-gray-900 dark:bg-black dark:hover:border-gray-800 max-sm:py-5 sm:w-[600px] sm:rounded-2xl sm:border",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"group flex gap-[10px]",children:[j&&!f?(0,s.jsx)(o.default,{src:j,alt:"".concat(E,"'s profile picture"),width:40,height:40,onError:()=>b(!0),className:"h-[40px] w-[40px] rounded-full object-cover"}):(0,s.jsx)("div",{className:"flex h-[40px] w-[40px] items-center justify-center rounded-full bg-gray-200 dark:bg-gray-800",children:(0,s.jsx)(l.A,{size:24,className:"text-gray-400"})}),(0,s.jsxs)("div",{className:"flex flex-col gap-px",children:[(0,s.jsx)("p",{className:"text-sm font-bold group-hover:text-blue-500",children:E||(0,s.jsx)("span",{className:"animate-pulse",children:"Loading..."})}),(0,s.jsxs)("p",{className:"text-sm text-gray-500",children:["@",w||(p?p.substring(0,8):"anonymous")]})]})]}),(0,s.jsx)("div",{className:"flex items-center gap-[15px] max-sm:gap-2.5",children:(0,s.jsx)("p",{className:"text-right text-sm text-gray-500",children:a(x)})})]}),R&&(0,s.jsx)(O,{content:u}),T&&g&&(0,s.jsx)("div",{className:"mt-4 flex items-center justify-start",children:(0,s.jsxs)("button",{onClick:g,className:"flex items-center gap-2 rounded-full bg-gray-100 px-3 py-1.5 text-sm text-gray-600 transition-colors hover:bg-gray-200 active:bg-gray-300 dark:bg-gray-800 dark:text-gray-400 dark:hover:bg-gray-700 dark:active:bg-gray-800",children:[(0,s.jsx)(i.A,{size:16}),(0,s.jsx)("span",{children:h.length}),(0,s.jsx)("span",{children:1===h.length?"reply":"replies"}),(0,s.jsx)("svg",{className:"h-4 w-4 transition-transform ".concat(m?"rotate-180":""),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]})}),m&&T&&(0,s.jsxs)("div",{className:"mt-4 space-y-3 rounded-lg",children:[(0,s.jsxs)("div",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:[h.length," ",1===h.length?"reply":"replies",":"]}),k(h,x.id).map(e=>_(e,0))]})]})}let U=e=>{let t=e.match(/https:\/\/.*?\.(jpeg|jpg|png|webp)/gi),r=e.match(/https:\/\/.*?\.(mp4|avi|mov)/gi);return{images:t?[...t]:[],videos:r?[...r]:[]}};function z(e){let{filterType:t,maxElements:r}=e,[a,l]=(0,c.useState)(new Set),{events:i}=(0,n.zE)({filter:{authors:["9c9f81ed795f0f5efa558932824687d84fc7e6a4cfa6db5d6d3b50fcb7ffaec2"],since:0,kinds:[1],limit:20}}),o=(0,c.useMemo)(()=>i.map(e=>e.id),[i]),{events:u}=(0,n.zE)({filter:{kinds:[1],"#e":o,since:0,limit:100},enabled:o.length>0}),{events:m}=(0,n.zE)({filter:{kinds:[1],"#p":["9c9f81ed795f0f5efa558932824687d84fc7e6a4cfa6db5d6d3b50fcb7ffaec2"],since:0,limit:50}}),{getProfile:h,loadProfile:g}=(0,d.K)();(0,c.useEffect)(()=>{let e=[...i,...u,...m];e.length>0&&[...new Set(e.map(e=>e.pubkey))].forEach(e=>{g(e)})},[i,u,m,g]);let x=e=>[...u.filter(t=>t.tags.some(t=>"e"===t[0]&&t[1]===e)),...m.filter(t=>t.tags.some(t=>"e"===t[0]&&t[1]===e)||t.content.includes(e))].filter((e,t,r)=>t===r.findIndex(t=>t.id===e.id)).sort((e,t)=>e.created_at-t.created_at),p=e=>{l(t=>{let r=new Set(t);return r.has(e)?r.delete(e):r.add(e),r})};return(0,s.jsx)("div",{className:"flex flex-col items-center overflow-x-hidden sm:gap-5",children:i.filter(e=>{let r=e.tags.some(e=>"e"===e[0]);if(r||e.tags.some(e=>"p"===e[0])&&r)return!1;let{images:s,videos:n}=U(e.content);return"image"===t&&!!(s.length>0)||"video"===t&&!!(n.length>0)||"text"===t&&0===s.length&&0===n.length||"all"===t}).slice(0,r).map(e=>{let t=h(e.pubkey),r=x(e.id),n=a.has(e.id);return(0,s.jsx)("div",{className:"w-full",children:(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)(A,{profilePicture:null==t?void 0:t.picture,displayName:null==t?void 0:t.display_name,username:null==t?void 0:t.name,timestamp:e,content:e.content,replies:r,showReplies:n,pubkey:e.pubkey,onToggleReplies:()=>p(e.id)}),(0,s.jsx)("div",{className:"h-px w-full bg-gray-200 dark:bg-gray-800 sm:h-0"})]})},e.id)})})}},90637:(e,t,r)=>{r.d(t,{H:()=>i,K:()=>o});var s=r(95155),n=r(12115),a=r(97049);let l=(0,n.createContext)({profiles:{},getProfile:()=>null,loadProfile:()=>{},isLoadingProfile:()=>!1});function i(e){let{children:t}=e,[r,i]=(0,n.useState)({}),[o,c]=(0,n.useState)(new Set),[d,u]=(0,n.useState)(new Set),m=(0,n.useRef)(new Set),{events:h}=(0,a.zE)({filter:{authors:Array.from(d),kinds:[0],limit:50},enabled:d.size>0});return(0,n.useEffect)(()=>{if(h.length>0){let e=new Set;i(t=>{let r={...t},s=!1;return h.forEach(n=>{try{if(e.add(n.pubkey),!t[n.pubkey]){let e=JSON.parse(n.content);r[n.pubkey]=e,s=!0}}catch(e){console.error("Error parsing profile:",e)}}),s?r:t}),e.size>0&&c(t=>{let r=new Set(t);return e.forEach(e=>{r.delete(e)}),r})}},[h]),(0,s.jsx)(l.Provider,{value:{profiles:r,getProfile:e=>r[e]||null,loadProfile:e=>{!(!e||r[e]||m.current.has(e))&&(o.has(e)||d.has(e)||(u(t=>{let r=new Set(t);return r.add(e),r}),c(t=>{let r=new Set(t);return r.add(e),r})))},isLoadingProfile:e=>o.has(e)},children:t})}let o=()=>(0,n.useContext)(l)},98590:(e,t,r)=>{r.d(t,{b:()=>a,p:()=>l});var s=r(95155),n=r(12115);let a=(0,n.createContext)({overlayImage:null,setOverlayImage:()=>{}}),l=e=>{let{children:t}=e,[r,l]=(0,n.useState)(null),i=(0,n.useCallback)(e=>{l(e),e?document.body.style.overflow="hidden":document.body.style.overflow="auto"},[]);return(0,n.useEffect)(()=>{let e=e=>{"Escape"===e.key&&r&&i(null)};return r&&window.addEventListener("keydown",e),()=>{window.removeEventListener("keydown",e)}},[r,i]),(0,s.jsxs)(a.Provider,{value:{overlayImage:r,setOverlayImage:i},children:[t,r&&(0,s.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-75 backdrop-blur-sm",onClick:e=>{e.target===e.currentTarget&&i(null)},children:(0,s.jsxs)("div",{className:"relative max-h-full max-w-full overflow-hidden",children:[(0,s.jsx)("button",{className:"absolute right-0 top-0 m-4 rounded-full bg-black/50 px-2 py-1 font-semibold text-white hover:bg-black/95",onClick:()=>i(null),children:"Close"}),(0,s.jsx)("img",{src:r,alt:"Fullscreen",className:"max-h-[90vh] max-w-[90vw] rounded-lg"})]})})]})}}}]);