"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[853],{65853:(e,t,r)=>{r.d(t,{A:()=>R});var s=r(95155),n=r(97049);function a(e){if(!e)return"";let t=new Date(1e3*e.created_at),r=t.getFullYear(),s=("0"+(t.getMonth()+1)).slice(-2),n=("0"+t.getDate()).slice(-2),a=t.getHours(),l=a,i=("0"+t.getMinutes()).slice(-2),c="AM";return a>12?(l=a-12,c="PM"):12===a?(l=12,c="PM"):0==a&&(l=12),n+"-"+s+"-"+r+", "+l+":"+i+" "+c}var l=r(71007),i=r(71366),c=r(66766),o=r(12115),d=r(90637),u=r(6874),m=r.n(u);function h(e){let{url:t,fallback:r}=e,[n,a]=(0,o.useState)(null),[l,i]=(0,o.useState)(!0),[c,d]=(0,o.useState)(!1);return((0,o.useEffect)(()=>{(async()=>{try{let e="https://api.allorigins.win/get?url=".concat(encodeURIComponent(t)),r=await fetch(e),s=await r.json(),n=new DOMParser().parseFromString(s.contents,"text/html"),l=e=>{let t=n.querySelector('meta[property="og:'.concat(e,'"]')),r=n.querySelector('meta[name="'.concat(e,'"]')),s=n.querySelector('meta[name="twitter:'.concat(e,'"]'));return(null==t?void 0:t.getAttribute("content"))||(null==r?void 0:r.getAttribute("content"))||(null==s?void 0:s.getAttribute("content"))||""},i={title:l("title")||n.title||"No title",description:l("description")||"",image:l("image")||"",url:l("url")||t,siteName:l("site_name")||""};a(i)}catch(e){console.error("Failed to fetch metadata:",e),d(!0)}finally{i(!1)}})()},[t]),l)?(0,s.jsxs)("div",{className:"w-full animate-pulse",children:[(0,s.jsx)("div",{className:"h-48 rounded-t-lg bg-gray-200"}),(0,s.jsxs)("div",{className:"space-y-3 rounded-b-lg border border-gray-200 p-4",children:[(0,s.jsx)("div",{className:"h-4 w-3/4 rounded bg-gray-200"}),(0,s.jsx)("div",{className:"h-3 rounded bg-gray-200"}),(0,s.jsx)("div",{className:"h-3 w-5/6 rounded bg-gray-200"})]})]}):c||!n?r||(0,s.jsx)("a",{href:t,className:"break-all text-blue-600 underline hover:text-blue-800",target:"_blank",rel:"noopener noreferrer",children:t}):(0,s.jsxs)(m(),{href:t,target:"_blank",rel:"noopener noreferrer",className:"group block w-full overflow-hidden rounded-lg border border-gray-200 bg-white shadow-sm transition-shadow duration-200 hover:shadow-md",children:[n.image&&(0,s.jsx)("div",{className:"aspect-video overflow-hidden",children:(0,s.jsx)("img",{src:n.image,alt:n.title,className:"h-full w-full object-cover transition-transform duration-200 group-hover:scale-105",onError:e=>{e.target.style.display="none"}})}),(0,s.jsxs)("div",{className:"p-4",children:[(0,s.jsx)("h3",{className:"mb-2 line-clamp-2 font-semibold text-gray-900 transition-colors group-hover:text-blue-600",children:n.title}),n.description&&(0,s.jsx)("p",{className:"mb-3 line-clamp-3 text-sm text-gray-600",children:n.description}),(0,s.jsxs)("div",{className:"flex items-center text-xs text-gray-500",children:[n.siteName&&(0,s.jsx)("span",{className:"font-medium",children:n.siteName}),(0,s.jsx)("span",{className:"ml-auto max-w-xs truncate",children:new URL(t).hostname})]})]})]})}let g=function(e){let t=/(#\w+)/g,r=e.split(/(\s+)/).flatMap(e=>e.split(t));return(0,s.jsx)(o.Fragment,{children:r.map((e,t)=>e.startsWith("#")?(0,s.jsx)("span",{className:"font-bold text-blue-500",children:e},t):(0,s.jsx)("span",{children:e},t))})};var x=r(98590);let p=()=>{let e=(0,o.useContext)(x.b);if(void 0===e)throw Error("useImageOverlay must be used within an ImageOverlayProvider");return e};var f=r(88275);class v{static createCombinedRegex(){let e=this.BECH32_NOTE_REGEX.source.slice(1,-1),t=this.NEVENT_REGEX.source.slice(1,-1),r=this.NOSTR_BECH32_NOTE_REGEX.source.slice(1,-1),s=this.NOSTR_NEVENT_REGEX.source.slice(1,-1);return RegExp("(".concat("https?:\\/\\/[^\\s\\n]+","|").concat(e,"|").concat(t,"|").concat(r,"|").concat(s,")"),"g")}static isNostrReference(e){let t=e.trim();return this.BECH32_NOTE_REGEX.lastIndex=0,this.NEVENT_REGEX.lastIndex=0,this.NOSTR_BECH32_NOTE_REGEX.lastIndex=0,this.NOSTR_NEVENT_REGEX.lastIndex=0,this.BECH32_NOTE_REGEX.test(t)||this.NEVENT_REGEX.test(t)||this.NOSTR_BECH32_NOTE_REGEX.test(t)||this.NOSTR_NEVENT_REGEX.test(t)}static extractNoteIdFromReference(e){return e.trim().replace(/^nostr:/,"")}static convertToHex(e){try{if(e.startsWith("note1")){let{data:t}=f.Qe.decode(e);if("string"==typeof t&&/^[a-f0-9]{64}$/.test(t))return t;return console.error("Decoded note ID is not in the expected hex format:",t),""}if(e.startsWith("nevent1")){let{type:t,data:r}=f.Qe.decode(e);if("nevent"!==t)return console.error("Decoded nevent is not of type 'nevent':",t),"";if(r.id&&/^[a-f0-9]{64}$/.test(r.id))return r.id;return console.error("nevent ID field is not in the expected hex format:",r.id),""}if(/^[a-f0-9]{64}$/.test(e))return e;return console.error("Note ID is not in a recognized format:",e),""}catch(e){return console.error("Error decoding note ID:",e),""}}static extractNoteIds(e){let t,r,s,n=[];for(;null!==(t=this.BECH32_NOTE_REGEX.exec(e));)t[1]&&n.push(t[1]);for(;null!==(r=this.NEVENT_REGEX.exec(e));)if(r[1])try{let{type:e,data:t}=f.Qe.decode(r[1]);if("note"===e){let e=f.Qe.noteEncode(t);n.push(e)}else if("nevent"===e){let e=f.Qe.noteEncode(t.id);n.push(e)}}catch(e){console.error("Error decoding nevent ID:",e)}let a=/nostr:(nevent1[a-zA-Z0-9]{20,})/g;for(;null!==(s=a.exec(e));)if(s[1])try{let{type:e,data:t}=f.Qe.decode(s[1]);if("note"===e){let e=f.Qe.noteEncode(t);n.push(e)}else if("nevent"===e){let e=f.Qe.noteEncode(t.id);n.push(e)}}catch(e){console.error("Error decoding nostr nevent ID:",e)}return[...new Set(n)]}static removeNostrReferences(e){let t=e;return(t=t.replace(this.NOSTR_PROFILE_REGEX,"")).replace(/[ \t]+/g," ")}}v.BECH32_NOTE_REGEX=/(note1[a-zA-Z0-9]{20,})/g,v.NEVENT_REGEX=/(nevent1[a-zA-Z0-9]{20,})/g,v.NOSTR_BECH32_NOTE_REGEX=/(nostr:note[a-zA-Z0-9]{59,65})/g,v.NOSTR_NEVENT_REGEX=/(nostr:nevent1[a-zA-Z0-9]{20,})/g,v.NOSTR_PROFILE_REGEX=/(nostr:npub[a-zA-Z0-9]{59,65})/g;class b{static cleanText(e){let t=e;return(t=(t=(t=t.replace(/\n{5,}/g,"\n\n\n\n")).split("\n").map(e=>""===e.trim()?"":e).join("\n")).replace(/[ ]{2,}/g," ")).trim()}static truncateUrls(e){return e.replace(/(https?:\/\/[^\s]{30,})/g,e=>{try{let t=new URL(e);return"".concat(t.hostname,"/...")}catch(t){return"".concat(e.substring(0,25),"...")}})}}class y{static isMediaUrl(e){return this.isImageUrl(e)||this.isVideoUrl(e)}static isImageUrl(e){return/https:\/\/.*?\.(jpeg|jpg|png|webp)/i.test(e)}static isVideoUrl(e){return/https:\/\/.*?\.(mp4|avi|mov)/i.test(e)}static isPreviewableUrl(e){try{let t=new URL(e);return!(["localhost","127.0.0.1"].includes(t.hostname)||[".pdf",".zip",".tar",".gz",".doc",".docx",".xls",".xlsx",".ppt",".pptx",".txt",".csv"].some(t=>e.toLowerCase().endsWith(t)))&&("http:"===t.protocol||"https:"===t.protocol)}catch(e){return!1}}static extractUrls(e){return e.match(this.URL_REGEX)||[]}static cleanUrl(e){return e.replace(/[.,;!?]*$/,"")}}y.URL_REGEX=/https?:\/\/[^\s\n]+/g;class N{static process(e){let t,r=[],s=0,n=v.extractNoteIds(e),a=v.createCombinedRegex(),l=[],i=0;for(;null!==(t=a.exec(e));){if(t.index>i){let r=e.substring(i,t.index);r&&l.push(r)}l.push(t[0]),i=t.index+t[0].length}if(i<e.length){let t=e.substring(i);t&&l.push(t)}let c="",o=()=>{if(c.trim()){let e=v.removeNostrReferences(c);e=e.replace(/(nostr:)?(note1[a-zA-Z0-9]{20,}|nevent1[a-zA-Z0-9]{20,})/g,""),e=b.truncateUrls(e),(e=b.cleanText(e))&&r.push({type:"text",content:e,index:s++}),c=""}};l.forEach(e=>{let t=e.trim();if(/^https?:\/\/[^\s]+$/.test(e)){let t=y.cleanUrl(e);if(y.isMediaUrl(t)){o();let n=y.isVideoUrl(t);r.push({type:n?"video":"image",content:t,index:s++,metadata:{originalUrl:e}})}else y.isPreviewableUrl(t)?(o(),r.push({type:"link",content:t,index:s++,metadata:{originalUrl:e}})):c+=e}else if(v.isNostrReference(t)){o();let e=v.extractNoteIdFromReference(t);r.push({type:"nostr_note",content:e,index:s++,metadata:{originalUrl:t}})}else c+=e}),o();let d=r.some(e=>"image"===e.type||"video"===e.type),u=r.some(e=>"link"===e.type);return{blocks:r,noteIds:n,hasMedia:d,hasLinks:u}}}let j=e=>{let t=e.match(/https:\/\/.*?\.(jpeg|jpg|png|webp)/gi),r=e.match(/https:\/\/.*?\.(mp4|avi|mov)/gi);return{images:t?[...t]:[],videos:r?[...r]:[]}},E=e=>{let{noteId:t}=e,[r,i]=(0,o.useState)(!1),u=v.convertToHex(t),{loadProfile:m,getProfile:h}=(0,d.K)(),{events:x,isLoading:p}=(0,n.zE)({filter:{ids:u?[u]:[],kinds:[1],limit:1},enabled:!!u}),f=x.length>0?x[0]:null;(0,o.useEffect)(()=>{(null==f?void 0:f.pubkey)&&m(f.pubkey)},[null==f?void 0:f.pubkey,m]);let b=(null==f?void 0:f.pubkey)?h(f.pubkey):null;if(p)return(0,s.jsxs)("div",{className:"animate-pulse rounded-md border bg-gray-50 p-3 dark:bg-gray-800",children:[(0,s.jsx)("div",{className:"mb-2 h-4 w-3/4 rounded bg-gray-200 dark:bg-gray-700"}),(0,s.jsx)("div",{className:"h-4 w-1/2 rounded bg-gray-200 dark:bg-gray-700"})]});if(!u)return(0,s.jsx)("div",{className:"rounded-md border bg-gray-50 p-4 dark:bg-gray-800",children:(0,s.jsx)("div",{className:"text-sm text-red-500",children:"Invalid note ID format"})});if(!f)return null;let{mediaUrls:y,textContent:N}=function(e){let t=j(e),r=e;return{mediaUrls:t,textContent:(r=(r=(r=(r=(r=(r=(r=(r=(r=(r=r.replace(/https:\/\/.*\.(jpeg|jpg|png|mp4|avi|mov|webp)/gi,"")).replace(/(nostr:note[a-zA-Z0-9]{59,65})/g,e=>{let t=e.substring(0,10),r=e.substring(e.length-6);return"".concat(t,"...").concat(r)})).replace(/(note1[a-zA-Z0-9]{20,})/g,e=>{let t=e.substring(0,5),r=e.substring(e.length-6);return"".concat(t,"...").concat(r)})).replace(/(nevent1[a-zA-Z0-9]{20,})/g,e=>{let t=e.substring(0,7),r=e.substring(e.length-6);return"".concat(t,"...").concat(r)})).replace(/(nostr:npub[a-zA-Z0-9]{59,65})/g,e=>{let t=e.substring(0,10),r=e.substring(e.length-6);return"".concat(t,"...").concat(r)})).replace(/(https?:\/\/[^\s]{30,})/g,e=>{try{let t=new URL(e).hostname;return"".concat(t,"/...")}catch(t){return"".concat(e.substring(0,25),"...")}})).replace(/\n{3,}/g,"\n\n")).split("\n").map(e=>""===e.trim()?"":e).join("\n")).replace(/\n\n\n+/g,"\n\n")).replace(/[ ]{2,}/g," ")).trim()}}(f.content),E=N.trim().length>0;return(0,s.jsxs)("div",{className:"rounded-lg border border-gray-200 p-4 transition hover:border-gray-300 dark:border-gray-900 dark:bg-black dark:hover:border-gray-800",children:[(0,s.jsxs)("div",{className:"mb-2 flex items-center",children:[(0,s.jsxs)("div",{className:"group flex items-center gap-2",children:[(null==b?void 0:b.picture)&&!r?(0,s.jsx)(c.default,{src:b.picture,alt:"".concat(b.display_name,"'s profile"),width:30,height:30,onError:()=>i(!0),className:"h-[30px] w-[30px] rounded-full object-cover"}):(0,s.jsx)("div",{className:"flex h-[30px] w-[30px] items-center justify-center rounded-full bg-gray-200 dark:bg-gray-700",children:(0,s.jsx)(l.A,{size:16,className:"text-gray-400"})}),(0,s.jsxs)("div",{className:"flex items-center gap-2.5",children:[(0,s.jsx)("div",{className:"text-sm font-semibold text-black group-hover:text-blue-500 dark:text-white",children:(null==b?void 0:b.display_name)||(null==b?void 0:b.name)||"".concat(f.pubkey.substring(0,8),"...")}),(0,s.jsxs)("div",{className:"text-sm text-gray-500",children:["@",null==b?void 0:b.name]})]})]}),(0,s.jsx)("div",{className:"ml-auto text-right text-xs text-gray-500",children:a(f)})]}),E&&(0,s.jsx)("div",{className:"hyphens-auto whitespace-pre-wrap text-sm leading-normal",children:g(N)}),y.images&&y.images.length>0&&(0,s.jsx)("div",{className:"mt-2",children:(0,s.jsx)(c.default,{src:y.images[0],alt:"Embedded media",width:300,height:200,className:"max-h-[500px] w-auto rounded-md object-cover"})})]})};function w(e){let{content:t,className:r=""}=e,{setOverlayImage:n}=p(),[a,l]=(0,o.useState)(new Set),{blocks:i}=N.process(t),d=e=>{l(t=>new Set(t).add(e))},u=(e,t,r)=>{let l=t===r-1;switch(e.type){case"text":return(0,s.jsx)("div",{className:"whitespace-pre-wrap leading-normal",children:g(e.content)},e.index);case"image":if(a.has(e.content))return null;return(0,s.jsx)("div",{className:"relative ".concat(l?"mt-3":"my-3"),children:(0,s.jsx)(c.default,{src:e.content,alt:"Media content",onClick:()=>n(e.content),width:1e3,height:1e3,className:"w-full scale-100 cursor-pointer rounded-xl transition hover:opacity-90 active:scale-[0.98]",onError:()=>d(e.content)})},e.index);case"video":return(0,s.jsx)("video",{src:e.content,className:"w-full rounded-[10px] ".concat(l?"mt-3":"my-3"),controls:!0,autoPlay:!0,muted:!0},e.index);case"link":return(0,s.jsx)("div",{className:l?"mt-3":"my-3",children:(0,s.jsx)(h,{url:e.content,fallback:(0,s.jsx)(m(),{href:e.content,className:"break-all text-blue-500 underline hover:text-blue-600 dark:text-blue-400 dark:hover:text-blue-300",target:"_blank",rel:"noopener noreferrer",children:e.content})})},e.index);case"nostr_note":return(0,s.jsx)("div",{className:l?"mt-3":"my-3",children:(0,s.jsx)(E,{noteId:e.content})},e.index);default:return null}};return(0,s.jsx)("div",{className:"flex flex-col ".concat(r),children:i.map((e,t)=>u(e,t,i.length))})}function k(e){let{content:t,className:r=""}=e;return(0,s.jsx)(w,{content:t,className:"text-sm ".concat(r)})}function _(e){let{profilePicture:t,displayName:r,username:n,content:u,showReplies:m=!1,replies:h=[],onToggleReplies:g,timestamp:x,pubkey:p}=e,[f,v]=(0,o.useState)(!1),{loadProfile:b,getProfile:y}=(0,d.K)();(0,o.useEffect)(()=>{p&&b(p)},[p,b]);let N=p?y(p):null,j=t||(null==N?void 0:N.picture),E=r||(null==N?void 0:N.display_name),_=n||(null==N?void 0:N.name),R=(e,t)=>e.filter(e=>{let r=e.tags.filter(e=>"e"===e[0]);if(0===r.length)return!1;let s=r[r.length-1];return s&&s[1]===t}).sort((e,t)=>e.created_at-t.created_at),S=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=y(e.pubkey),n=Math.min(t,6),i=R(h,e.id);return(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{style:{marginLeft:"".concat(16*n,"px")},className:"border-l-2 border-gray-300 py-3 pl-3 dark:border-gray-600",children:(0,s.jsxs)("div",{className:"flex items-start gap-3",children:[(null==r?void 0:r.picture)?(0,s.jsx)(c.default,{src:r.picture,alt:"".concat(r.display_name,"'s profile picture"),width:32,height:32,className:"h-8 w-8 rounded-full object-cover"}):(0,s.jsx)("div",{className:"flex h-8 w-8 items-center justify-center rounded-full bg-gray-200 dark:bg-gray-800",children:(0,s.jsx)(l.A,{size:16,className:"text-gray-400"})}),(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 text-xs text-gray-600 dark:text-gray-400",children:[(0,s.jsx)("span",{className:"font-semibold",children:(null==r?void 0:r.display_name)||"@".concat(null==r?void 0:r.name)||0}),(0,s.jsx)("span",{children:"â€¢"}),(0,s.jsx)("span",{children:a(e)})]}),(0,s.jsx)("div",{className:"mt-1",children:(0,s.jsx)(k,{content:e.content})})]})]})}),i.length>0&&(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)("div",{className:"absolute bottom-0 top-0 w-0.5 bg-gray-300 dark:bg-gray-600",style:{left:"".concat(16*n,"px")}}),(0,s.jsx)("div",{children:i.map(e=>S(e,t+1))})]})]},e.id)},T=u.trim().length>0,I=h.length>0;return(0,s.jsxs)("div",{className:"flex flex-col gap-2.5 border-gray-200 px-4 py-4 transition duration-200 hover:border-gray-300 dark:border-gray-900 dark:bg-black dark:hover:border-gray-800 max-sm:py-5 sm:w-[600px] sm:rounded-2xl sm:border",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"group flex gap-[10px]",children:[j&&!f?(0,s.jsx)(c.default,{src:j,alt:"".concat(E,"'s profile picture"),width:40,height:40,onError:()=>v(!0),className:"h-[40px] w-[40px] rounded-full object-cover"}):(0,s.jsx)("div",{className:"flex h-[40px] w-[40px] items-center justify-center rounded-full bg-gray-200 dark:bg-gray-800",children:(0,s.jsx)(l.A,{size:24,className:"text-gray-400"})}),(0,s.jsxs)("div",{className:"flex flex-col gap-px",children:[(0,s.jsx)("p",{className:"text-sm font-bold group-hover:text-blue-500",children:E||(0,s.jsx)("span",{className:"animate-pulse",children:"Loading..."})}),(0,s.jsxs)("p",{className:"text-sm text-gray-500",children:["@",_||(p?p.substring(0,8):"anonymous")]})]})]}),(0,s.jsx)("div",{className:"flex items-center gap-[15px] max-sm:gap-2.5",children:(0,s.jsx)("p",{className:"text-right text-sm text-gray-500",children:a(x)})})]}),T&&(0,s.jsx)(w,{content:u}),I&&g&&(0,s.jsx)("div",{className:"mt-4 flex items-center justify-start",children:(0,s.jsxs)("button",{onClick:g,className:"flex items-center gap-2 rounded-full bg-gray-100 px-3 py-1.5 text-sm text-gray-600 transition-colors hover:bg-gray-200 dark:bg-gray-800 dark:text-gray-400 dark:hover:bg-gray-700",children:[(0,s.jsx)(i.A,{size:16}),(0,s.jsx)("span",{children:h.length}),(0,s.jsx)("span",{children:1===h.length?"reply":"replies"}),(0,s.jsx)("svg",{className:"h-4 w-4 transition-transform ".concat(m?"rotate-180":""),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]})}),m&&I&&(0,s.jsxs)("div",{className:"mt-4 space-y-3 rounded-lg",children:[(0,s.jsxs)("div",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:[h.length," ",1===h.length?"reply":"replies",":"]}),R(h,x.id).map(e=>S(e,0))]})]})}function R(e){let{filterType:t,maxElements:r}=e,[a,l]=(0,o.useState)(new Set),{events:i}=(0,n.zE)({filter:{authors:["9c9f81ed795f0f5efa558932824687d84fc7e6a4cfa6db5d6d3b50fcb7ffaec2"],since:0,kinds:[1],limit:20}}),c=(0,o.useMemo)(()=>i.map(e=>e.id),[i]),{events:u}=(0,n.zE)({filter:{kinds:[1],"#e":c,since:0,limit:100},enabled:c.length>0}),{events:m}=(0,n.zE)({filter:{kinds:[1],"#p":["9c9f81ed795f0f5efa558932824687d84fc7e6a4cfa6db5d6d3b50fcb7ffaec2"],since:0,limit:50}}),{getProfile:h,loadProfile:g}=(0,d.K)();(0,o.useEffect)(()=>{let e=[...i,...u,...m];e.length>0&&[...new Set(e.map(e=>e.pubkey))].forEach(e=>{g(e)})},[i,u,m,g]);let x=e=>[...u.filter(t=>t.tags.some(t=>"e"===t[0]&&t[1]===e)),...m.filter(t=>t.tags.some(t=>"e"===t[0]&&t[1]===e)||t.content.includes(e))].filter((e,t,r)=>t===r.findIndex(t=>t.id===e.id)).sort((e,t)=>e.created_at-t.created_at),p=e=>{l(t=>{let r=new Set(t);return r.has(e)?r.delete(e):r.add(e),r})};return(0,s.jsx)("div",{className:"flex flex-col items-center overflow-x-hidden sm:gap-5",children:i.filter(e=>{let r=e.tags.some(e=>"e"===e[0]);if(r||e.tags.some(e=>"p"===e[0])&&r)return!1;let{images:s,videos:n}=j(e.content);return"image"===t&&!!(s.length>0)||"video"===t&&!!(n.length>0)||"text"===t&&0===s.length&&0===n.length||"all"===t}).slice(0,r).map(e=>{let t=h(e.pubkey),r=x(e.id),n=a.has(e.id);return(0,s.jsx)("div",{className:"w-full",children:(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)(_,{profilePicture:null==t?void 0:t.picture,displayName:null==t?void 0:t.display_name,username:null==t?void 0:t.name,timestamp:e,content:e.content,replies:r,showReplies:n,pubkey:e.pubkey,onToggleReplies:()=>p(e.id)}),(0,s.jsx)("div",{className:"h-px w-full bg-gray-200 dark:bg-gray-800 sm:h-0"})]})},e.id)})})}},90637:(e,t,r)=>{r.d(t,{H:()=>i,K:()=>c});var s=r(95155),n=r(12115),a=r(97049);let l=(0,n.createContext)({profiles:{},getProfile:()=>null,loadProfile:()=>{},isLoadingProfile:()=>!1});function i(e){let{children:t}=e,[r,i]=(0,n.useState)({}),[c,o]=(0,n.useState)(new Set),[d,u]=(0,n.useState)(new Set),m=(0,n.useRef)(new Set),{events:h}=(0,a.zE)({filter:{authors:Array.from(d),kinds:[0],limit:50},enabled:d.size>0});return(0,n.useEffect)(()=>{if(h.length>0){let e=new Set;i(t=>{let r={...t},s=!1;return h.forEach(n=>{try{if(e.add(n.pubkey),!t[n.pubkey]){let e=JSON.parse(n.content);r[n.pubkey]=e,s=!0}}catch(e){console.error("Error parsing profile:",e)}}),s?r:t}),e.size>0&&o(t=>{let r=new Set(t);return e.forEach(e=>{r.delete(e)}),r})}},[h]),(0,s.jsx)(l.Provider,{value:{profiles:r,getProfile:e=>r[e]||null,loadProfile:e=>{!(!e||r[e]||m.current.has(e))&&(c.has(e)||d.has(e)||(u(t=>{let r=new Set(t);return r.add(e),r}),o(t=>{let r=new Set(t);return r.add(e),r})))},isLoadingProfile:e=>c.has(e)},children:t})}let c=()=>(0,n.useContext)(l)},98590:(e,t,r)=>{r.d(t,{b:()=>a,p:()=>l});var s=r(95155),n=r(12115);let a=(0,n.createContext)({overlayImage:null,setOverlayImage:()=>{}}),l=e=>{let{children:t}=e,[r,l]=(0,n.useState)(null),i=(0,n.useCallback)(e=>{l(e),e?document.body.style.overflow="hidden":document.body.style.overflow="auto"},[]);return(0,n.useEffect)(()=>{let e=e=>{"Escape"===e.key&&r&&i(null)};return r&&window.addEventListener("keydown",e),()=>{window.removeEventListener("keydown",e)}},[r,i]),(0,s.jsxs)(a.Provider,{value:{overlayImage:r,setOverlayImage:i},children:[t,r&&(0,s.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-75 backdrop-blur-sm",onClick:e=>{e.target===e.currentTarget&&i(null)},children:(0,s.jsxs)("div",{className:"relative max-h-full max-w-full overflow-hidden",children:[(0,s.jsx)("button",{className:"absolute right-0 top-0 m-4 rounded-full bg-black/50 px-2 py-1 font-semibold text-white hover:bg-black/95",onClick:()=>i(null),children:"Close"}),(0,s.jsx)("img",{src:r,alt:"Fullscreen",className:"max-h-[90vh] max-w-[90vw] rounded-lg"})]})})]})}}}]);