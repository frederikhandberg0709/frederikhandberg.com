"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[549],{33549:(e,t,r)=>{r.d(t,{A:()=>v});var l=r(95155),n=r(97049);function a(e){if(!e)return"";let t=new Date(1e3*e.created_at),r=t.getFullYear(),l=("0"+(t.getMonth()+1)).slice(-2),n=("0"+t.getDate()).slice(-2),a=t.getHours(),s=a,i=("0"+t.getMinutes()).slice(-2),c="AM";return a>12?(s=a-12,c="PM"):12===a?(s=12,c="PM"):0==a&&(s=12),n+"-"+l+"-"+r+", "+s+":"+i+" "+c}var s=r(88275);let i=e=>{let t=e.match(/https:\/\/.*?\.(jpeg|jpg|png|webp)/gi),r=e.match(/https:\/\/.*?\.(mp4|avi|mov)/gi);return{images:t?[...t]:[],videos:r?[...r]:[]}};function c(e){let t=i(e),r=e;return{mediaUrls:t,textContent:(r=(r=(r=(r=(r=(r=(r=(r=(r=(r=r.replace(/https:\/\/.*\.(jpeg|jpg|png|mp4|avi|mov|webp)/gi,"")).replace(/(nostr:note[a-zA-Z0-9]{59,65})/g,e=>{let t=e.substring(0,10),r=e.substring(e.length-6);return"".concat(t,"...").concat(r)})).replace(/(note1[a-zA-Z0-9]{20,})/g,e=>{let t=e.substring(0,5),r=e.substring(e.length-6);return"".concat(t,"...").concat(r)})).replace(/(nevent1[a-zA-Z0-9]{20,})/g,e=>{let t=e.substring(0,7),r=e.substring(e.length-6);return"".concat(t,"...").concat(r)})).replace(/(nostr:npub[a-zA-Z0-9]{59,65})/g,e=>{let t=e.substring(0,10),r=e.substring(e.length-6);return"".concat(t,"...").concat(r)})).replace(/(https?:\/\/[^\s]{30,})/g,e=>{try{let t=new URL(e).hostname;return"".concat(t,"/...")}catch(t){return"".concat(e.substring(0,25),"...")}})).replace(/\n{3,}/g,"\n\n")).split("\n").map(e=>""===e.trim()?"":e).join("\n")).replace(/\n\n\n+/g,"\n\n")).replace(/[ ]{2,}/g," ")).trim()}}var o=r(12115);let d=function(e){let t=/(#\w+)/g,r=e.split(/(\s+)/).flatMap(e=>e.split(t));return(0,l.jsx)(o.Fragment,{children:r.map((e,t)=>e.startsWith("#")?(0,l.jsx)("span",{className:"font-bold text-blue-500",children:e},t):(0,l.jsx)("span",{children:e},t))})};var u=r(98590);let g=()=>{let e=(0,o.useContext)(u.b);if(void 0===e)throw Error("useImageOverlay must be used within an ImageOverlayProvider");return e};var m=r(71007),p=r(66766),h=r(90637);let x=e=>{let{noteId:t}=e,[r,i]=(0,o.useState)(!1),u=function(e){try{if(e.startsWith("note1")){let{data:t}=s.Qe.decode(e);if("string"==typeof t&&/^[a-f0-9]{64}$/.test(t))return t;return console.error("Decoded note ID is not in the expected hex format:",t),""}if(/^[a-f0-9]{64}$/.test(e))return e;return console.error("Note ID is not in a recognized format:",e),""}catch(e){return console.error("Error decoding note ID:",e),""}}(t),{loadProfile:g,getProfile:x}=(0,h.K)(),{events:f,isLoading:v}=(0,n.zE)({filter:{ids:u?[u]:[],kinds:[1],limit:1},enabled:!!u}),b=f.length>0?f[0]:null;(0,o.useEffect)(()=>{(null==b?void 0:b.pubkey)&&g(b.pubkey)},[null==b?void 0:b.pubkey,g]);let y=(null==b?void 0:b.pubkey)?x(b.pubkey):null;if(v)return(0,l.jsxs)("div",{className:"animate-pulse rounded-md border bg-gray-50 p-3 dark:bg-gray-800",children:[(0,l.jsx)("div",{className:"mb-2 h-4 w-3/4 rounded bg-gray-200 dark:bg-gray-700"}),(0,l.jsx)("div",{className:"h-4 w-1/2 rounded bg-gray-200 dark:bg-gray-700"})]});if(!u)return(0,l.jsx)("div",{className:"rounded-md border bg-gray-50 p-4 dark:bg-gray-800",children:(0,l.jsx)("div",{className:"text-sm text-red-500",children:"Invalid note ID format"})});if(!b)return null;let{mediaUrls:j,textContent:w}=c(b.content),N=w.trim().length>0;return(0,l.jsxs)("div",{className:"rounded-lg border border-gray-200 p-4 transition hover:border-gray-300",children:[(0,l.jsxs)("div",{className:"mb-2 flex items-center",children:[(0,l.jsxs)("div",{className:"group flex items-center gap-2",children:[(null==y?void 0:y.picture)&&!r?(0,l.jsx)(p.default,{src:y.picture,alt:"".concat(y.display_name,"'s profile"),width:30,height:30,onError:()=>i(!0),className:"h-[30px] w-[30px] rounded-full object-cover"}):(0,l.jsx)("div",{className:"flex h-[30px] w-[30px] items-center justify-center rounded-full bg-gray-200 dark:bg-gray-700",children:(0,l.jsx)(m.A,{size:16,className:"text-gray-400"})}),(0,l.jsxs)("div",{className:"flex items-center gap-2.5",children:[(0,l.jsx)("div",{className:"text-sm font-semibold text-black group-hover:text-blue-500 dark:text-white",children:(null==y?void 0:y.display_name)||(null==y?void 0:y.name)||"".concat(b.pubkey.substring(0,8),"...")}),(0,l.jsxs)("div",{className:"text-sm text-gray-500",children:["@",null==y?void 0:y.name]})]})]}),(0,l.jsx)("div",{className:"ml-auto text-right text-xs text-gray-500",children:a(b)})]}),N&&(0,l.jsx)("div",{className:"hyphens-auto whitespace-pre-wrap text-sm leading-normal",children:d(w)}),j.images&&j.images.length>0&&(0,l.jsx)("div",{className:"mt-2",children:(0,l.jsx)(p.default,{src:j.images[0],alt:"Embedded media",width:300,height:200,className:"max-h-[500px] w-auto rounded-md object-cover"})})]})};function f(e){let{profilePicture:t,displayName:r,username:n,content:i,timestamp:u,pubkey:f}=e,{setOverlayImage:v}=g(),[b,y]=(0,o.useState)(!1),[j,w]=(0,o.useState)([]),{mediaUrls:N,textContent:k}=c(i),{loadProfile:E,getProfile:S}=(0,h.K)();(0,o.useEffect)(()=>{f&&E(f)},[f,E]);let z=f?S(f):null,P=t||(null==z?void 0:z.picture),C=r||(null==z?void 0:z.display_name),I=n||(null==z?void 0:z.name);(0,o.useEffect)(()=>{w(function(e){let t,r,l=/(note1[a-zA-Z0-9]{20,})/g,n=/(nevent1[a-zA-Z0-9]{20,})/g,a=[];for(;null!==(t=l.exec(e));)t[1]&&a.push(t[1]);for(;null!==(r=n.exec(e));)if(r[1]){let e=r[1];try{let{type:t,data:r}=s.Qe.decode(e);if("note"===t){let e=s.Qe.noteEncode(r);a.push(e)}else if("nevent"===t){let e=s.Qe.noteEncode(r.id);a.push(e)}}catch(e){console.error("Error decoding nevent ID:",e)}}return a}(i))},[i]);let A=k.trim().length>0;return(0,l.jsxs)("div",{className:"flex flex-col gap-2.5 border-gray-200 p-4 transition duration-200 hover:border-gray-300 dark:border-gray-900 dark:bg-black dark:hover:border-gray-800 sm:w-[600px] sm:rounded-2xl sm:border",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsxs)("div",{className:"group flex gap-[10px]",children:[P&&!b?(0,l.jsx)(p.default,{src:P,alt:"".concat(C,"'s profile picture"),width:40,height:40,onError:()=>y(!0),className:"h-[40px] w-[40px] rounded-full object-cover"}):(0,l.jsx)("div",{className:"flex h-[40px] w-[40px] items-center justify-center rounded-full bg-gray-200 dark:bg-gray-800",children:(0,l.jsx)(m.A,{size:24,className:"text-gray-400"})}),(0,l.jsxs)("div",{className:"flex flex-col gap-px",children:[(0,l.jsx)("p",{className:"text-sm font-bold group-hover:text-blue-500",children:C||(0,l.jsx)("span",{className:"animate-pulse",children:"Loading..."})}),(0,l.jsxs)("p",{className:"text-sm text-gray-500",children:["@",I||(f?f.substring(0,8):"anonymous")]})]})]}),(0,l.jsx)("div",{className:"flex items-center gap-[15px] max-sm:gap-2.5",children:(0,l.jsx)("p",{className:"text-right text-sm text-gray-500",children:a(u)})})]}),A&&(0,l.jsx)("div",{className:"hyphens-auto whitespace-pre-wrap leading-normal",children:d(k)}),j.length>0&&(0,l.jsx)("div",{className:"mt-4",children:j.map(e=>(0,l.jsx)(x,{noteId:e},e))}),(e=>{let{images:t,videos:r}=e;return(null==t?void 0:t.length)||(null==r?void 0:r.length)?(0,l.jsxs)("div",{className:"flex flex-col gap-4",children:[t.map((e,t)=>(0,l.jsx)("div",{className:"relative",children:(0,l.jsx)(p.default,{src:e,alt:"Media content ".concat(t+1),onClick:()=>v(e),width:1e3,height:1e3,className:"w-full scale-100 cursor-pointer rounded-xl transition hover:opacity-90 active:scale-[0.98]",onError:()=>y(!0)})},"img-".concat(t))),r.map((e,t)=>(0,l.jsx)("video",{src:e,className:"w-full rounded-[10px]",controls:!0,autoPlay:!0,muted:!0},"video-".concat(t)))]}):null})(N)]})}function v(e){let{filterType:t,maxElements:r}=e,{events:a}=(0,n.zE)({filter:{authors:["9c9f81ed795f0f5efa558932824687d84fc7e6a4cfa6db5d6d3b50fcb7ffaec2"],since:0,kinds:[1],limit:20}}),{getProfile:s,loadProfile:c}=(0,h.K)();return(0,o.useEffect)(()=>{a.length>0&&[...new Set(a.map(e=>e.pubkey))].forEach(e=>{c(e)})},[a,c]),(0,l.jsx)("div",{className:"flex flex-col items-center gap-[20px] overflow-x-hidden sm:gap-[10px]",children:a.filter(e=>{let{images:r,videos:l}=i(e.content);return"image"===t&&!!(r.length>0)||"video"===t&&!!(l.length>0)||"text"===t&&0===r.length&&0===l.length||"all"===t}).slice(0,r).map(e=>{let t=s(e.pubkey);return(0,l.jsxs)("div",{children:[(0,l.jsx)(f,{profilePicture:null==t?void 0:t.picture,displayName:null==t?void 0:t.display_name,username:null==t?void 0:t.name,timestamp:e,content:e.content,pubkey:e.pubkey}),(0,l.jsx)("div",{className:"h-px w-full bg-gray-200 dark:bg-gray-800 sm:h-0"})]},e.id)})})}},90637:(e,t,r)=>{r.d(t,{H:()=>i,K:()=>c});var l=r(95155),n=r(12115),a=r(97049);let s=(0,n.createContext)({profiles:{},getProfile:()=>null,loadProfile:()=>{},isLoadingProfile:()=>!1});function i(e){let{children:t}=e,[r,i]=(0,n.useState)({}),[c,o]=(0,n.useState)(new Set),[d,u]=(0,n.useState)(new Set),g=(0,n.useRef)(new Set),{events:m}=(0,a.zE)({filter:{authors:Array.from(d),kinds:[0],limit:50},enabled:d.size>0});return(0,n.useEffect)(()=>{if(m.length>0){let e=new Set;i(t=>{let r={...t},l=!1;return m.forEach(n=>{try{if(e.add(n.pubkey),!t[n.pubkey]){let e=JSON.parse(n.content);r[n.pubkey]=e,l=!0}}catch(e){console.error("Error parsing profile:",e)}}),l?r:t}),e.size>0&&o(t=>{let r=new Set(t);return e.forEach(e=>{r.delete(e)}),r})}},[m]),(0,l.jsx)(s.Provider,{value:{profiles:r,getProfile:e=>r[e]||null,loadProfile:e=>{!(!e||r[e]||g.current.has(e))&&(c.has(e)||d.has(e)||(u(t=>{let r=new Set(t);return r.add(e),r}),o(t=>{let r=new Set(t);return r.add(e),r})))},isLoadingProfile:e=>c.has(e)},children:t})}let c=()=>(0,n.useContext)(s)},98590:(e,t,r)=>{r.d(t,{b:()=>a,p:()=>s});var l=r(95155),n=r(12115);let a=(0,n.createContext)({overlayImage:null,setOverlayImage:()=>{}}),s=e=>{let{children:t}=e,[r,s]=(0,n.useState)(null),i=(0,n.useCallback)(e=>{s(e),e?document.body.style.overflow="hidden":document.body.style.overflow="auto"},[]);return(0,n.useEffect)(()=>{let e=e=>{"Escape"===e.key&&r&&i(null)};return r&&window.addEventListener("keydown",e),()=>{window.removeEventListener("keydown",e)}},[r,i]),(0,l.jsxs)(a.Provider,{value:{overlayImage:r,setOverlayImage:i},children:[t,r&&(0,l.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-75 backdrop-blur-sm",onClick:e=>{e.target===e.currentTarget&&i(null)},children:(0,l.jsxs)("div",{className:"relative max-h-full max-w-full overflow-hidden",children:[(0,l.jsx)("button",{className:"absolute right-0 top-0 m-4 rounded-full bg-black/50 px-2 py-1 font-semibold text-white hover:bg-black/95",onClick:()=>i(null),children:"Close"}),(0,l.jsx)("img",{src:r,alt:"Fullscreen",className:"max-h-[90vh] max-w-[90vw] rounded-lg"})]})})]})}}}]);